riot.tag2("app-header",'<h1>🌳 mission forest β</h1> <ul class="left"> <li>explore</li> <li>create</li> </ul> <ul class="right"> <li>白松さんようこそ</li> </ul>','app-header,[riot-tag="app-header"],[data-is="app-header"]{ display: block; height: 57px; background: #27ae60; border-bottom: 1px solid #e6e6e6; color: white; } app-header h1,[riot-tag="app-header"] h1,[data-is="app-header"] h1{ margin: 0; padding: 16px 0px 0px 20px; color: white; text-align: center; font-size: 18px; font-weight: normal; } app-header .left,[riot-tag="app-header"] .left,[data-is="app-header"] .left{ position: absolute; left: 20px; top: 0; padding: 0; } app-header .right,[riot-tag="app-header"] .right,[data-is="app-header"] .right{ position: absolute; right: 20px; top: 0; padding: 0; } app-header .left li,[riot-tag="app-header"] .left li,[data-is="app-header"] .left li{ float: left; list-style: none; margin-right: 40px; font-size: 16px; } app-header .right li,[riot-tag="app-header"] .right li,[data-is="app-header"] .right li{ float: right; list-style: none; margin-left: 40px; font-size: 16px; }',"",function(t){}),riot.tag2("app-main",'<mission-tree editable="{true}"></mission-tree>','app-main,[riot-tag="app-main"],[data-is="app-main"]{ display: block; position: absolute; top: 58px; right: 0; bottom: 0; left: 0; }',"",function(t){}),riot.tag2("app",'<app-header title="ミッションフォレスト"></app-header> <app-main></app-main>','app,[riot-tag="app"],[data-is="app"]{ display: block; height: 100%; background: #F5F6FA; }',"",function(t){}),riot.tag2("mission-tree-task-modal",'<div class="container"> <a onclick="{toggle}"><i class="fa fa-times"></i></a> <h3><i class="fa fa-thumb-tack"></i>タスク詳細</h3> <p>タスクの説明。タスクの説明。タスクの説明。タスクの説明。タスクの説明。タスクの説明。タスクの説明。タスクの説明。タスクの説明。タスクの説明。タスクの説明。タスクの説明。</p> <textarea></textarea> </div>','mission-tree-task-modal,[riot-tag="mission-tree-task-modal"],[data-is="mission-tree-task-modal"]{ position: fixed; width: 100%; height: 100%; left: 0; top: 0; z-index: 20; background-color: rgba(0, 0, 0, .6); } mission-tree-task-modal .container,[riot-tag="mission-tree-task-modal"] .container,[data-is="mission-tree-task-modal"] .container{ width: 700px; margin: 60px auto; padding: 20px; background: #EDEFF0; border-radius: 4px; } mission-tree-task-modal h3,[riot-tag="mission-tree-task-modal"] h3,[data-is="mission-tree-task-modal"] h3{ margin: 0; color: #4d4d4d; }',"",function(t){this.toggle=function(t){return this.parent.flag=!1,!0}.bind(this)}),riot.tag2("mission-tree-task",'<div id="container"> <h3>{opts.task.title}</h3> <ul> <li><i class="fa fa-comment-o"></i> 10</li> <li><i class="fa fa-clock-o"></i> 5分前</li> </ul> <img src="https://scontent.xx.fbcdn.net/v/t1.0-1/p160x160/12359971_10208210916098488_3680404975307201989_n.jpg?oh=c901bd62f5db75161387634399091fd2&oe=5878B594"> <a if="{showAdd}"><i class="fa fa-plus"></i></a> </div>','mission-tree-task,[riot-tag="mission-tree-task"],[data-is="mission-tree-task"]{ position: absolute; } mission-tree-task #container,[riot-tag="mission-tree-task"] #container,[data-is="mission-tree-task"] #container{ display: block; padding: 15px; position: absolute; width: 220px; height: 100px; background: white; border-radius: 4px; box-shadow: 0 1px 3px rgba(0, 0, 0, .1); cursor: pointer; } mission-tree-task #container:hover,[riot-tag="mission-tree-task"] #container:hover,[data-is="mission-tree-task"] #container:hover{ box-shadow: 0 1px 6px rgba(0, 0, 0, .3); } mission-tree-task h3,[riot-tag="mission-tree-task"] h3,[data-is="mission-tree-task"] h3{ overflow: hidden; height: 72px; margin: 0; font-size: 16px; font-weight: normal; } mission-tree-task ul,[riot-tag="mission-tree-task"] ul,[data-is="mission-tree-task"] ul{ float: left; margin: 0; padding: 0; } mission-tree-task li,[riot-tag="mission-tree-task"] li,[data-is="mission-tree-task"] li{ float: left; margin-right: 10px; list-style: none; color: #8c8c8c; font-size: 14px; } mission-tree-task img,[riot-tag="mission-tree-task"] img,[data-is="mission-tree-task"] img{ float: right; width: 30px; height: 30px; border-radius: 4px; } mission-tree-task a,[riot-tag="mission-tree-task"] a,[data-is="mission-tree-task"] a{ display: block; position: absolute; left: 95px; bottom: -30px; width: 60px; height: 30px; border-radius: 0 0 60px 60px; -moz-border-radius: 0 0 60px 60px; -webkit-border-radius: 0 0 60px 60px; background: white; font-size: 18px; } mission-tree-task a i,[riot-tag="mission-tree-task"] a i,[data-is="mission-tree-task"] a i{ color: #8c8c8c; padding: 0px 22px; } mission-tree-task a:hover,[riot-tag="mission-tree-task"] a:hover,[data-is="mission-tree-task"] a:hover{ background: #ccc; }',"",function(t){this.showAdd=!1,this.on("mount",function(){$("#container",this.root).css({left:t.position.x+"px",top:t.position.y+"px"}),$("#container",this.root).draggable({containment:"#map",start:function(t,i){console.log("start event start"),console.log(t,i)},drag:function(t,i){console.log("drag event start"),console.log(t,i)},stop:function(t,i){console.log("stop event start"),console.log(t,i)}}),$("#container",this.root).hover(function(){this.showAdd=!0},function(){this.showAdd=!1})})}),riot.tag2("mission-tree",'<div id="map"> <mission-tree-task each="{node in nodes}" position="{node.position}" task="{node.value}" onclick="{parent.toggle}"></mission-tree-task> </div> <canvas width="2000" height="1000"></canvas> <mission-tree-task-modal show="{flag}">','mission-tree,[riot-tag="mission-tree"],[data-is="mission-tree"]{ display: block; position: absolute; top: 0; right: 0; bottom: 0; left: 0; } mission-tree #map,[riot-tag="mission-tree"] #map,[data-is="mission-tree"] #map{ position: absolute; top: 58px; right: 0; bottom: 0; left: 0; }',"",function(t){function i(t,i){this.value=t,this.position={x:l,y:h},this.childNodes=i}function a(t){var o=[];return s.forEach(function(i){i.parent==t.id&&o.push(a(i))}),new i(t,o)}function o(t){var i=t.childNodes.length;t.childNodes.forEach(function(a,e){a.position={x:t.position.x+(n*i+p*(i-1))/i*e-(n*i+p*(i-1))/2,y:t.position.y+r+d},o(a)})}function e(t){t.childNodes.forEach(function(i){g.push({parent:t,value:i.value,position:i.position}),e(i)})}this.flag=!1;var s=[{id:1,title:"ミッションフォレストを開発する",parent:null},{id:2,title:"ライブラリの選定",parent:1},{id:3,title:"マスターDBの選定",parent:2},{id:6,title:"UIの設計",parent:1},{id:7,title:"ワイヤーフレームワーク",parent:6},{id:8,title:"実装",parent:1},{id:10,title:"ツリーエディター",parent:8}],n=250,r=130,p=60,d=140,l=$(window,this.root).width()/2,h=60,c=a(s[0]);o(c);var g=[{parent:null,value:c.value,position:c.position}];this.draw=function(t){var i=$("canvas",this.root);t.forEach(function(t){i.drawBezier({strokeStyle:"#FAC414",strokeWidth:3,x1:t.start.x+n/2,y1:t.start.y+r/2,cx1:t.start.x+n/2,cy1:(t.start.y+t.end.y)/2+r/2,cx2:t.end.x+n/2,cy2:(t.start.y+t.end.y)/2+r/2,x2:t.end.x+n/2,y2:t.end.y+r/2})})},this.canvas=$("canvas",this.root),this.on("update",function(){e(c),this.nodes=g;var t=g.map(function(t,i){return t.parent?{start:t.parent.position,end:t.position}:{}});t.shift(),this.draw(t)}),this.toggle=function(t){t.node;return this.flag=!0,!0}.bind(this)});